<template lwc:render-mode="light">
    <site-common-panel onclose={handleCloseMiniCart}>
        <site-checkout-stencil-unified
            stencil-type={_headerStencilType}
            item-count={_stencilHeaderItemCount}
            lwc:if={showStencils}
            slot="panelHeading"></site-checkout-stencil-unified>
        <div
            slot="panelHeading"
            lwc:else
            lwc:ref="panelHeading"
            class="panelHeading"
            tabindex="0">
            {headerLabel}
        </div>
        <site-checkout-stencil-unified
            stencil-type={_stencilType}
            item-count={_stencilCartItemCount}
            lwc:if={showStencils}
            slot="panelBody"></site-checkout-stencil-unified>
        <site-cart-items-ui
            lwc:else
            items={_cartItems}
            show-remove-item={_showRemoveItem}
            show-product-image={_showProductImage}
            show-product-variants={_showProductVariants}
            show-total-prices={_showTotalPrices}
            show-original-price={_showOriginalPrice}
            show-actual-price={_showActualPrice}
            show-promotions={showPromotions}
            show-sku={_showSku}
            pagination-type={_paginationType}
            currency-iso-code={_currencyIsoCode}
            onupdatecartitem={handleUpdateCartItem}
            ondeletecartitem={handleDeleteCartItem}
            onnavigatetoproduct={handleProductNavigation}
            oncartshowmore={handleCartShowMore}
            slot="panelBody"></site-cart-items-ui>
        <div
            lwc:if={showEmptyCart}
            slot="panelBody">
            <p data-automation="empty_cart">{emptyMiniCartLabel}</p>
        </div>
        <!-- Recommendation -->
        <div
            lwc:if={showRecommendation}
            slot="panelBody">
            <hr class="divider" />
            <experience-carousel-v2
                hide-for-fewer-than={_recommendationHideForFewerThan}
                items={collection}
                layout={_recommendationLayout}
                width={_recommendationWidth}>
                <div slot="carouselHeader">
                    <h3 class="custom-text-block">{recommendationHeaderText}</h3>
                </div>
                <template
                    slot="sfdcRepeaterItem"
                    lwc:slot-data="item">
                    <commerce-product-card
                        currency={_currencyIsoCode}
                        data-id={item.data.id}
                        data-primary-price={item.data.prices.unitPrice}
                        data-product-name={item.data.name}
                        image={item.data.images}
                        is-product-available
                        is-on-wishlist={item.data.isOnWishlist}
                        onproductclicked={handleRecommendationProductClicked}
                        onwishlistbuttonclicked={handleWishlistButtonClicked}
                        primary-price={item.data.prices.unitPrice}
                        product-id={item.data.id}
                        product-name={item.data.name}
                        product-url={item.data.urlName}
                        secondary-price={item.data.prices.listPrice}
                        show-product-image
                        show-wishlist-icon></commerce-product-card>
                </template>
            </experience-carousel-v2>
        </div>
        <div
            slot="panelFooter"
            class="panel-footer">
            <site-checkout-button-ui
                alignment="center"
                can-checkout={canCheckout}
                managed-checkout-version={_managedCheckoutVersion}
                cart-id={cartId}
                currency-code={_currencyIsoCode}
                disabled={isDisabled}
                size={checkoutButtonSize}
                text={checkoutButtonText}
                variant="primary"
                width="stretch"></site-checkout-button-ui>
            <site-checkout-payment-by-express-wrapper
                lwc:if={showExpressCheckoutComponent}
                payment-method-set-id={expressCheckoutPmsId}
                is-logged-in={_isLoggedIn}
                express-mode={_expressMode}
                cart-summary={_cartSummary}
                use-manual-capture={expressCheckoutUseManualCapture}
                inventory-configuration={_inventoryConfiguration}
                default-currency={_currencyIsoCode}
                guest-checkout-enabled={_guestCheckoutEnabled}
                effective-account-id={_effectiveAccountId}
                webstore-id={_webstoreId}
                button-size={checkoutButtonSize}
                onnavigateorderconfirmation={handleOrderPageNavigation}></site-checkout-payment-by-express-wrapper>
            <site-common-button-ui
                lwc:if={showContinueShoppingButton}
                class={continueShoppingButtonCustomClasses}
                onclick={handleCloseMiniCart}
                size={continueShoppingButtonSize}
                variant="secondary"
                width="stretch">
                {continueShoppingButtonText}
            </site-common-button-ui>
            <site-common-button-ui
                lwc:if={showViewCartButton}
                class={viewCartButtonCustomClasses}
                onclick={handleViewCart}
                size={viewCartButtonSize}
                variant="tertiary"
                width="stretch">
                {viewCartButtonText}
            </site-common-button-ui>
        </div>
    </site-common-panel>
    <div
        class="slds-backdrop slds-backdrop_open"
        role="presentation"
        onclick={handleCloseMiniCart}></div>
</template>
